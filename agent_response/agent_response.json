[
  {
    "id": "ed3e7cfe-3245-40ab-87f9-7c9642a3361c",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-15T06:49:55.250359+00:00",
    "logs": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-15T06:49:45.029869+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-15T06:49:49.599+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-15T06:49:49.628+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-15T06:49:45.029869+00:00 [queued]>\n[2025-04-15T06:49:49.647+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-15T06:49:45.029869+00:00 [queued]>\n[2025-04-15T06:49:49.648+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-15T06:49:49.672+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-15 06:49:45.029869+00:00\n[2025-04-15T06:49:49.688+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=1987) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-15T06:49:49.691+0000] {standard_task_runner.py:72} INFO - Started process 1989 to run task\n[2025-04-15T06:49:49.691+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-15T06:49:45.029869+00:00', '--job-id', '156', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmp0dn_3f9y']\n[2025-04-15T06:49:49.695+0000] {standard_task_runner.py:105} INFO - Job 156: Subtask print_date\n[2025-04-15T06:49:49.801+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-15T06:49:45.029869+00:00 [running]> on host 98afc59ad8de\n[2025-04-15T06:49:49.941+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-15T06:49:45.029869+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-15T06:49:45.029869+00:00'\n[2025-04-15T06:49:49.943+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-15T06:49:49.943+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-15T06:49:49.945+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-15 06:49:49.630285+00:00\n[2025-04-15T06:49:49.946+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-15T06:49:49.947+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-15T06:49:49.948+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-15T06:49:49.976+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-15T06:49:49.976+0000] {logging_mixin.py:190} INFO - Task start:2025-04-15 06:49:49.630285+00:00 end:2025-04-15 06:49:49.975485+00:00 duration:0.3452\n[2025-04-15T06:49:49.978+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-15 06:49:45.029869+00:00: manual__2025-04-15T06:49:45.029869+00:00, state:running, queued_at: 2025-04-15 06:49:45.109112+00:00. externally triggered: True>\n[2025-04-15T06:49:49.979+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-15T06:49:49.981+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-15T06:49:45.029869+00:00, execution_date=20250415T064945, start_date=20250415T064949, end_date=20250415T064949\n[2025-04-15T06:49:50.024+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-15T06:49:50.028+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 156 for task print_date (name 'subprocess' is not defined; 1989)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-15T06:49:50.091+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-15T06:49:50.138+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-15T06:49:50.146+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    },
    "analysis": "The error message indicates that the `subprocess` module is not imported in your Python script, which is causing a `NameError`. The `subprocess` module is used to execute external commands and processes.\n\nTo fix this issue, you need to add an import statement at the top of your Python script:\n```python\nimport subprocess\n```\nAlternatively, if you're using Python 3.5 or later, you can use the `run()` function from the `subprocess` module instead of calling it directly:\n```python\nfrom subprocess import run\n\n# ...\n\nresult = run([\"date\"], check=True)\n```\nMake sure to update your script with the correct import statement and usage.\n\nAdditionally, if you're running this code in an Airflow environment, ensure that the Python interpreter used by Airflow is configured to use the `subprocess` module. You can do this by setting the `PYTHONPATH` environment variable or using a virtual environment.",
    "slack_message_result": "Message sent to Slack successfully. \n  Try this Solution: {'ok': True, 'channel': 'C08MAV0NK71', 'ts': '1744700137.039679', 'message': {'user': 'U08MVBRBM9S', 'type': 'message', 'ts': '1744700137.039679', 'bot_id': 'B08MVBRB39A', 'app_id': 'A08MJSAEM3Q', 'text': '{\"dag_name\": \"modern_slack_notification_dag\", \"error_message\": \"The subprocess module is not imported in your Python script, which is causing a NameError. To fix this issue, add an import statement at the top of your Python script: \\nimport subprocess\\nOr use the run() function from the subprocess module instead of calling it directly:\\nfrom subprocess import run\\n# ...\\nresult = run([\\'date\\'], check=True)\\n\"}', 'team': 'T08MWB5HE3T', 'bot_profile': {'id': 'B08MVBRB39A', 'app_id': 'A08MJSAEM3Q', 'user_id': 'U08MVBRBM9S', 'name': 'Airflow Notifications', 'icons': {'image_36': 'https://a.slack-edge.com/80588/img/plugins/app/bot_36.png', 'image_48': 'https://a.slack-edge.com/80588/img/plugins/app/bot_48.png', 'image_72': 'https://a.slack-edge.com/80588/img/plugins/app/service_72.png'}, 'deleted': False, 'updated': 1744359517, 'team_id': 'T08MWB5HE3T'}, 'blocks': [{'type': 'rich_text', 'block_id': 'd/46S', 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': '{\"dag_name\": \"modern_slack_notification_dag\", \"error_message\": \"The subprocess module is not imported in your Python script, which is causing a NameError. To fix this issue, add an import statement at the top of your Python script: \\nimport subprocess\\nOr use the run() function from the subprocess module instead of calling it directly:\\nfrom subprocess import run\\n# ...\\nresult = run([\\'date\\'], check=True)\\n\"}'}]}]}]}}"
  },
  {
    "id": "e5e41195-bf59-4e5e-a00d-3ad76ca9d1a6",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-15T06:24:25.461510+00:00",
    "logs": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-15T06:24:13.240362+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-15T06:24:19.840+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-15T06:24:19.880+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-15T06:24:13.240362+00:00 [queued]>\n[2025-04-15T06:24:19.901+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-15T06:24:13.240362+00:00 [queued]>\n[2025-04-15T06:24:19.905+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-15T06:24:19.938+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-15 06:24:13.240362+00:00\n[2025-04-15T06:24:19.951+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=1692) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-15T06:24:19.955+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-15T06:24:13.240362+00:00', '--job-id', '155', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmp1f0lsuuy']\n[2025-04-15T06:24:19.956+0000] {standard_task_runner.py:72} INFO - Started process 1694 to run task\n[2025-04-15T06:24:19.961+0000] {standard_task_runner.py:105} INFO - Job 155: Subtask print_date\n[2025-04-15T06:24:20.083+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-15T06:24:13.240362+00:00 [running]> on host 98afc59ad8de\n[2025-04-15T06:24:20.239+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-15T06:24:13.240362+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-15T06:24:13.240362+00:00'\n[2025-04-15T06:24:20.243+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-15T06:24:20.244+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-15T06:24:20.246+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-15 06:24:19.882291+00:00\n[2025-04-15T06:24:20.248+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-15T06:24:20.250+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-15T06:24:20.254+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-15T06:24:20.306+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-15T06:24:20.309+0000] {logging_mixin.py:190} INFO - Task start:2025-04-15 06:24:19.882291+00:00 end:2025-04-15 06:24:20.303917+00:00 duration:0.421626\n[2025-04-15T06:24:20.316+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-15 06:24:13.240362+00:00: manual__2025-04-15T06:24:13.240362+00:00, state:running, queued_at: 2025-04-15 06:24:13.352065+00:00. externally triggered: True>\n[2025-04-15T06:24:20.319+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-15T06:24:20.320+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-15T06:24:13.240362+00:00, execution_date=20250415T062413, start_date=20250415T062419, end_date=20250415T062420\n[2025-04-15T06:24:20.409+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-15T06:24:20.412+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 155 for task print_date (name 'subprocess' is not defined; 1694)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-15T06:24:20.487+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-15T06:24:20.533+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-15T06:24:20.542+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    },
    "analysis": "The issue here is that the `subprocess` module is not imported in your Python script.\n\nTo fix this, you need to add an import statement at the top of your script:\n```python\nimport subprocess\n```\nThis will allow you to use the `subprocess.run()` function without any issues.\n\nHere's the updated code snippet with the import statement added:\n```python\nimport subprocess\n\ndef print_date():\n    try:\n        subprocess.run([\"date\"], check=True)\n    except subprocess.CalledProcessError as e:\n        print(f\"Error: {e}\")\n\nprint_date()\n```\nNote that I've also wrapped the `subprocess.run()` call in a `try`-`except` block to catch any exceptions that might occur. This is a good practice when working with external commands like this.",
    "slack_message_result": "Message sent to Slack successfully. \n  Try this Solution: {'ok': True, 'channel': 'C08MAV0NK71', 'ts': '1744698559.146319', 'message': {'user': 'U08MVBRBM9S', 'type': 'message', 'ts': '1744698559.146319', 'bot_id': 'B08MVBRB39A', 'app_id': 'A08MJSAEM3Q', 'text': '{\"Error in modern_slack_notification_dag: The subprocess module is not imported in your Python script.\\nFix: Add import statement at the top of your script (e.g. \u00b4import subprocess\u00b4)\\nUpdated code snippet:\\n\\nimport subprocess\\n\\ndef print_date():\\n    try:\\n        subprocess.run([\"date\"], check=True)\\n    except subprocess.CalledProcessError as e:\\n        print(f\"Error: {e}\")\\n\\nprint_date()\"}', 'team': 'T08MWB5HE3T', 'bot_profile': {'id': 'B08MVBRB39A', 'app_id': 'A08MJSAEM3Q', 'user_id': 'U08MVBRBM9S', 'name': 'Airflow Notifications', 'icons': {'image_36': 'https://a.slack-edge.com/80588/img/plugins/app/bot_36.png', 'image_48': 'https://a.slack-edge.com/80588/img/plugins/app/bot_48.png', 'image_72': 'https://a.slack-edge.com/80588/img/plugins/app/service_72.png'}, 'deleted': False, 'updated': 1744359517, 'team_id': 'T08MWB5HE3T'}, 'blocks': [{'type': 'rich_text', 'block_id': 'MEz', 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': '{\"Error in modern_slack_notification_dag: The subprocess module is not imported in your Python script.\\nFix: Add import statement at the top of your script (e.g. \u00b4import subprocess\u00b4)\\nUpdated code snippet:\\n\\nimport subprocess\\n\\ndef print_date():\\n    try:\\n        subprocess.run([\"date\"], check=True)\\n    except subprocess.CalledProcessError as e:\\n        print(f\"Error: {e}\")\\n\\nprint_date()\"}'}]}]}]}}"
  },
  {
    "id": "a02b6032-7b84-4d5a-b1c0-74de09cbbaa7",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-15T06:06:36.080129+00:00",
    "logs": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-15T06:06:25.938719+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-15T06:06:30.660+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-15T06:06:30.698+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-15T06:06:25.938719+00:00 [queued]>\n[2025-04-15T06:06:30.717+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-15T06:06:25.938719+00:00 [queued]>\n[2025-04-15T06:06:30.718+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-15T06:06:30.744+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-15 06:06:25.938719+00:00\n[2025-04-15T06:06:30.756+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=1494) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-15T06:06:30.759+0000] {standard_task_runner.py:72} INFO - Started process 1496 to run task\n[2025-04-15T06:06:30.762+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-15T06:06:25.938719+00:00', '--job-id', '154', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmp6j6ul1ae']\n[2025-04-15T06:06:30.767+0000] {standard_task_runner.py:105} INFO - Job 154: Subtask print_date\n[2025-04-15T06:06:30.869+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-15T06:06:25.938719+00:00 [running]> on host 98afc59ad8de\n[2025-04-15T06:06:31.023+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-15T06:06:25.938719+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-15T06:06:25.938719+00:00'\n[2025-04-15T06:06:31.027+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-15T06:06:31.028+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-15T06:06:31.031+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-15 06:06:30.700096+00:00\n[2025-04-15T06:06:31.032+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-15T06:06:31.034+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-15T06:06:31.038+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-15T06:06:31.086+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-15T06:06:31.088+0000] {logging_mixin.py:190} INFO - Task start:2025-04-15 06:06:30.700096+00:00 end:2025-04-15 06:06:31.085503+00:00 duration:0.385407\n[2025-04-15T06:06:31.089+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-15 06:06:25.938719+00:00: manual__2025-04-15T06:06:25.938719+00:00, state:running, queued_at: 2025-04-15 06:06:26.002531+00:00. externally triggered: True>\n[2025-04-15T06:06:31.091+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-15T06:06:31.092+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-15T06:06:25.938719+00:00, execution_date=20250415T060625, start_date=20250415T060630, end_date=20250415T060631\n[2025-04-15T06:06:31.147+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-15T06:06:31.149+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 154 for task print_date (name 'subprocess' is not defined; 1496)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-15T06:06:31.203+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-15T06:06:31.257+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-15T06:06:31.264+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    },
    "analysis": "The error message indicates that the `subprocess` module is not imported in your Python script, which is causing a `NameError` when trying to use it.\n\nTo fix this issue, you need to add an import statement for the `subprocess` module at the top of your script:\n```python\nimport subprocess\n```\nAlternatively, if you are using Python 3.5 or later, you can also use the `run()` function from the `subprocess` module, which is a more modern and safer way to run external commands:\n```python\nfrom subprocess import run\n\nrun([\"date\"], check=True)\n```\nMake sure to add this import statement before trying to use the `subprocess.run()` or `subprocess.check_output()` functions.\n\nHere's an example of how your script might look with the necessary import statement added:\n```python\nimport subprocess\n\ndef print_date():\n    subprocess.run([\"date\"], check=True)\n\nprint_date()\n```\nThis should fix the error and allow your script to run successfully.",
    "slack_message_result": "Message sent to Slack successfully. \n  Try this Solution: {'ok': True, 'channel': 'C08MAV0NK71', 'ts': '1744697556.722719', 'message': {'user': 'U08MVBRBM9S', 'type': 'message', 'ts': '1744697556.722719', 'bot_id': 'B08MVBRB39A', 'app_id': 'A08MJSAEM3Q', 'text': '{\"error\": \"The `subprocess` module is not imported in your Python script, which is causing a `NameError` when trying to use it. To fix this issue, you need to add an import statement for the `subprocess` module at the top of your script: \\\\n\\\\nimport subprocess\\\\n\\\\nAlternatively, if you are using Python 3.5 or later, you can also use the `run()` function from the `subprocess` module, which is a more modern and safer way to run external commands:\\\\n\\\\nfrom subprocess import run\\\\n\\\\nrun([\"date\"], check=True)\\n\\\\nThis should fix the error and allow your script to run successfully.\"}', 'team': 'T08MWB5HE3T', 'bot_profile': {'id': 'B08MVBRB39A', 'app_id': 'A08MJSAEM3Q', 'user_id': 'U08MVBRBM9S', 'name': 'Airflow Notifications', 'icons': {'image_36': 'https://a.slack-edge.com/80588/img/plugins/app/bot_36.png', 'image_48': 'https://a.slack-edge.com/80588/img/plugins/app/bot_48.png', 'image_72': 'https://a.slack-edge.com/80588/img/plugins/app/service_72.png'}, 'deleted': False, 'updated': 1744359517, 'team_id': 'T08MWB5HE3T'}, 'blocks': [{'type': 'rich_text', 'block_id': '9Vib', 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': '{\"error\": \"The '}, {'type': 'text', 'text': 'subprocess', 'style': {'code': True}}, {'type': 'text', 'text': ' module is not imported in your Python script, which is causing a '}, {'type': 'text', 'text': 'NameError', 'style': {'code': True}}, {'type': 'text', 'text': ' when trying to use it. To fix this issue, you need to add an import statement for the '}, {'type': 'text', 'text': 'subprocess', 'style': {'code': True}}, {'type': 'text', 'text': ' module at the top of your script: \\\\n\\\\nimport subprocess\\\\n\\\\nAlternatively, if you are using Python 3.5 or later, you can also use the '}, {'type': 'text', 'text': 'run()', 'style': {'code': True}}, {'type': 'text', 'text': ' function from the '}, {'type': 'text', 'text': 'subprocess', 'style': {'code': True}}, {'type': 'text', 'text': ' module, which is a more modern and safer way to run external commands:\\\\n\\\\nfrom subprocess import run\\\\n\\\\nrun([\"date\"], check=True)\\n\\\\nThis should fix the error and allow your script to run successfully.\"}'}]}]}]}}"
  },
  {
    "id": "8ac40f34-bd59-4788-abfe-fb1aec398988",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-15T05:35:58.019783+00:00",
    "logs": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-15T05:35:45.378967+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-15T05:35:51.105+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-15T05:35:51.140+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-15T05:35:45.378967+00:00 [queued]>\n[2025-04-15T05:35:51.155+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-15T05:35:45.378967+00:00 [queued]>\n[2025-04-15T05:35:51.156+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-15T05:35:51.183+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-15 05:35:45.378967+00:00\n[2025-04-15T05:35:51.192+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=1142) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-15T05:35:51.198+0000] {standard_task_runner.py:72} INFO - Started process 1144 to run task\n[2025-04-15T05:35:51.200+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-15T05:35:45.378967+00:00', '--job-id', '153', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmp4c2tgdqm']\n[2025-04-15T05:35:51.204+0000] {standard_task_runner.py:105} INFO - Job 153: Subtask print_date\n[2025-04-15T05:35:51.430+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-15T05:35:45.378967+00:00 [running]> on host 98afc59ad8de\n[2025-04-15T05:35:51.961+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-15T05:35:45.378967+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-15T05:35:45.378967+00:00'\n[2025-04-15T05:35:51.964+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-15T05:35:51.968+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-15T05:35:51.976+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-15 05:35:51.141263+00:00\n[2025-04-15T05:35:51.978+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-15T05:35:51.981+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-15T05:35:51.985+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-15T05:35:52.025+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-15T05:35:52.027+0000] {logging_mixin.py:190} INFO - Task start:2025-04-15 05:35:51.141263+00:00 end:2025-04-15 05:35:52.024930+00:00 duration:0.883667\n[2025-04-15T05:35:52.030+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-15 05:35:45.378967+00:00: manual__2025-04-15T05:35:45.378967+00:00, state:running, queued_at: 2025-04-15 05:35:45.505828+00:00. externally triggered: True>\n[2025-04-15T05:35:52.032+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-15T05:35:52.033+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-15T05:35:45.378967+00:00, execution_date=20250415T053545, start_date=20250415T053551, end_date=20250415T053552\n[2025-04-15T05:35:52.096+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-15T05:35:52.099+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 153 for task print_date (name 'subprocess' is not defined; 1144)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-15T05:35:52.148+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-15T05:35:52.228+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-15T05:35:52.239+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    },
    "analysis": "The error message indicates that there's a `NameError` exception being raised due to an undefined variable named `subprocess`. The `subprocess` module in Python is used for spawning new processes, retrieving their output, and waiting for them to complete. \n\nTo fix this issue, you need to import the `subprocess` module at the beginning of your script.\n\nHere's how you can modify your code:\n\n```python\nimport subprocess\n\ndef print_date():\n    # Your existing code here...\n    result = subprocess.run([\"date\"], check=True)\n    if result.returncode == 0:\n        # Process the output as needed\n        pass\n    else:\n        # Handle any errors that occurred while running the command\n        pass\n\nprint_date()\n```\n\nBy adding `import subprocess` at the beginning of your script, you're ensuring that the `subprocess` module is available for use in your code. This should resolve the `NameError` exception and allow your script to run without issues.\n\nAlternatively, if you're using Python 3.5 or later, you can also import the `subprocess` module from its `subprocess` package:\n\n```python\nfrom subprocess import subprocess\n\ndef print_date():\n    # Your existing code here...\n    result = subprocess.run([\"date\"], check=True)\n    if result.returncode == 0:\n        # Process the output as needed\n        pass\n    else:\n        # Handle any errors that occurred while running the command\n        pass\n\nprint_date()\n```\n\nThis approach is a bit more explicit and avoids naming conflicts with other modules in Python.",
    "slack_message_result": "Message sent to Slack successfully."
  },
  {
    "id": "ede6b0af-41fd-48e7-964b-c523b0675873",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-15T05:16:25.070919+00:00",
    "logs": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-15T05:16:12.853701+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-15T05:16:18.589+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-15T05:16:18.632+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-15T05:16:12.853701+00:00 [queued]>\n[2025-04-15T05:16:18.646+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-15T05:16:12.853701+00:00 [queued]>\n[2025-04-15T05:16:18.647+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-15T05:16:18.681+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-15 05:16:12.853701+00:00\n[2025-04-15T05:16:18.691+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=914) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-15T05:16:18.694+0000] {standard_task_runner.py:72} INFO - Started process 916 to run task\n[2025-04-15T05:16:18.694+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-15T05:16:12.853701+00:00', '--job-id', '152', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmppqmmutv_']\n[2025-04-15T05:16:18.697+0000] {standard_task_runner.py:105} INFO - Job 152: Subtask print_date\n[2025-04-15T05:16:18.812+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-15T05:16:12.853701+00:00 [running]> on host 98afc59ad8de\n[2025-04-15T05:16:18.977+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-15T05:16:12.853701+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-15T05:16:12.853701+00:00'\n[2025-04-15T05:16:18.979+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-15T05:16:18.981+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-15T05:16:18.982+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-15 05:16:18.633518+00:00\n[2025-04-15T05:16:18.984+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-15T05:16:18.986+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-15T05:16:18.988+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-15T05:16:19.022+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-15T05:16:19.023+0000] {logging_mixin.py:190} INFO - Task start:2025-04-15 05:16:18.633518+00:00 end:2025-04-15 05:16:19.022138+00:00 duration:0.38862\n[2025-04-15T05:16:19.026+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-15 05:16:12.853701+00:00: manual__2025-04-15T05:16:12.853701+00:00, state:running, queued_at: 2025-04-15 05:16:12.881503+00:00. externally triggered: True>\n[2025-04-15T05:16:19.028+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-15T05:16:19.029+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-15T05:16:12.853701+00:00, execution_date=20250415T051612, start_date=20250415T051618, end_date=20250415T051619\n[2025-04-15T05:16:19.086+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-15T05:16:19.089+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 152 for task print_date (name 'subprocess' is not defined; 916)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-15T05:16:19.140+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-15T05:16:19.166+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    },
    "analysis": "The error message indicates that the `subprocess` module is not imported in your Python script, which is causing a `NameError`. The `subprocess` module is used to execute external commands and processes.\n\nTo fix this issue, you need to import the `subprocess` module at the top of your Python script. Add the following line:\n```python\nimport subprocess\n```\nThis will allow you to use the `subprocess.run()` function to execute the `date` command.\n\nHere's an example of how you can modify your code to fix this issue:\n```python\nimport subprocess\n\ndef print_date():\n    # ... (rest of your code remains the same)\n    result = subprocess.run([\"date\"], check=True)\n    # ... (rest of your code remains the same)\n\nprint_date()\n```\nAlternatively, you can also use the `os` module to execute the command:\n```python\nimport os\n\ndef print_date():\n    # ... (rest of your code remains the same)\n    result = os.system(\"date\")\n    # ... (rest of your code remains the same)\n\nprint_date()\n```\nMake sure to replace the `subprocess.run()` call with either the `os.system()` or `subprocess.run()` calls, depending on your specific requirements.",
    "slack_message_result": "Message sent to Slack successfully."
  },
  {
    "id": "c3a05e4a-4f03-46fd-b8f3-9cb94b0b427b",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-15T05:12:11.262343+00:00",
    "logs": "",
    "analysis": "",
    "slack_message_result": ""
  },
  {
    "id": "fd6c4652-3d0c-458f-b24b-34f15092819d",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-15T05:10:20.555944+00:00",
    "logs": "",
    "analysis": "",
    "slack_message_result": ""
  },
  {
    "id": "f5cf7d47-5d9f-4428-8008-753f8a3dec61",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-15T04:44:26.303478+00:00",
    "logs": "{\"logs\": <fetch_logs(\"modern_slack_notification_dag\")>}",
    "analysis": "",
    "slack_message_result": ""
  },
  {
    "id": "dd677ae3-ff15-4670-acae-d29bb1d6c3b8",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T08:46:25.329735+00:00",
    "logs": "Logs:\n{'print_date': '98afc59ad8de\\n INFO - ::group::Log message source details\\n*** Found local files:\\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T08:46:08.388988+00:00/task_id=print_date/attempt=1.log\\n INFO - ::endgroup::\\n[2025-04-14T08:46:19.620+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\\n[2025-04-14T08:46:19.659+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T08:46:08.388988+00:00 [queued]>\\n[2025-04-14T08:46:19.678+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T08:46:08.388988+00:00 [queued]>\\n[2025-04-14T08:46:19.680+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\\n[2025-04-14T08:46:19.713+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 08:46:08.388988+00:00\\n[2025-04-14T08:46:19.727+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=3449) is multi-threaded, use of fork() may lead to deadlocks in the child.\\n  pid = os.fork()\\n[2025-04-14T08:46:19.731+0000] {standard_task_runner.py:72} INFO - Started process 3451 to run task\\n[2025-04-14T08:46:19.732+0000] {standard_task_runner.py:104} INFO - Running: [\\'***\\', \\'tasks\\', \\'run\\', \\'modern_slack_notification_dag\\', \\'print_date\\', \\'manual__2025-04-14T08:46:08.388988+00:00\\', \\'--job-id\\', \\'143\\', \\'--raw\\', \\'--subdir\\', \\'DAGS_FOLDER/slack_notifier_dag.py\\', \\'--cfg-path\\', \\'/tmp/tmptdaic9wj\\']\\n[2025-04-14T08:46:19.736+0000] {standard_task_runner.py:105} INFO - Job 143: Subtask print_date\\n[2025-04-14T08:46:19.845+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T08:46:08.388988+00:00 [running]> on host 98afc59ad8de\\n[2025-04-14T08:46:20.029+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER=\\'***\\' AIRFLOW_CTX_DAG_ID=\\'modern_slack_notification_dag\\' AIRFLOW_CTX_TASK_ID=\\'print_date\\' AIRFLOW_CTX_EXECUTION_DATE=\\'2025-04-14T08:46:08.388988+00:00\\' AIRFLOW_CTX_TRY_NUMBER=\\'1\\' AIRFLOW_CTX_DAG_RUN_ID=\\'manual__2025-04-14T08:46:08.388988+00:00\\'\\n[2025-04-14T08:46:20.036+0000] {logging_mixin.py:190} INFO - Task instance is in running state\\n[2025-04-14T08:46:20.037+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\\n[2025-04-14T08:46:20.038+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 08:46:19.660522+00:00\\n[2025-04-14T08:46:20.040+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\\n[2025-04-14T08:46:20.042+0000] {taskinstance.py:732} INFO - ::endgroup::\\n[2025-04-14T08:46:20.045+0000] {taskinstance.py:3313} ERROR - Task failed with exception\\nTraceback (most recent call last):\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\\n    result = _execute_callable(context=context, **execute_callable_kwargs)\\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\\n    return ExecutionCallableRunner(\\n           ^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\\n    return self.func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\\n    return func(self, *args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\\n    return_value = super().execute(context)\\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\\n    return func(self, *args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\\n    return_value = self.execute_callable()\\n                   ^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\\n    return runner.run(*self.op_args, **self.op_kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\\n    return self.func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\\n    subprocess.run([\"date\"], check=True)\\n    ^^^^^^^^^^\\nNameError: name \\'subprocess\\' is not defined. Did you forget to import \\'subprocess\\'\\n[2025-04-14T08:46:20.097+0000] {logging_mixin.py:190} INFO - Task instance in failure state\\n[2025-04-14T08:46:20.099+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 08:46:19.660522+00:00 end:2025-04-14 08:46:20.097153+00:00 duration:0.436631\\n[2025-04-14T08:46:20.100+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 08:46:08.388988+00:00: manual__2025-04-14T08:46:08.388988+00:00, state:running, queued_at: 2025-04-14 08:46:08.529948+00:00. externally triggered: True>\\n[2025-04-14T08:46:20.101+0000] {logging_mixin.py:190} INFO - Failure caused by name \\'subprocess\\' is not defined\\n[2025-04-14T08:46:20.103+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T08:46:08.388988+00:00, execution_date=20250414T084608, start_date=20250414T084619, end_date=20250414T084620\\n[2025-04-14T08:46:20.169+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\\n[2025-04-14T08:46:20.171+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 143 for task print_date (name \\'subprocess\\' is not defined; 3451)\\nTraceback (most recent call last):\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\\n    ret = args.func(args, dag=self.dag)\\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\\n    return func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\\n    return f(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\\n    return _run_raw_task(args, ti)\\n           ^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\\n    return ti._run_raw_task(\\n           ^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\\n    return func(*args, session=session, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\\n    return _run_raw_task(\\n           ^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\\n    TaskInstance._execute_task_with_callbacks(\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\\n    result = self._execute_task(context, task_orig)\\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\\n    return _execute_task(self, context, task_orig)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\\n    result = _execute_callable(context=context, **execute_callable_kwargs)\\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\\n    return ExecutionCallableRunner(\\n           ^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\\n    return self.func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\\n    return func(self, *args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\\n    return_value = super().execute(context)\\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\\n    return func(self, *args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\\n    return_value = self.execute_callable()\\n                   ^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\\n    return runner.run(*self.op_args, **self.op_kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\\n    return self.func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\\n    subprocess.run([\"date\"], check=True)\\n    ^^^^^^^^^^\\nNameError: name \\'subprocess\\' is not defined. Did you forget to import \\'subprocess\\'\\n[2025-04-14T08:46:20.221+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\\n[2025-04-14T08:46:20.274+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\\n[2025-04-14T08:46:20.287+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\\n', 'sleep_task': 'default_host\\nError fetching the logs. Try number 0 is invalid.\\n'}\n\nAnalysis:\nThe error message indicates that the `subprocess` module is not imported in the script. The `subprocess` module is a Python standard library that allows you to run external commands and capture their output.\n\nTo fix this issue, you need to import the `subprocess` module at the top of your script:\n```python\nimport subprocess\n```\nAdditionally, it's a good practice to handle exceptions that may occur when running external commands. You can do this by wrapping the call to `subprocess.run()` in a try-except block:\n```python\ntry:\n    result = subprocess.run([\"date\"], check=True)\nexcept subprocess.CalledProcessError as e:\n    print(f\"Error: {e}\")\n```\nThis will catch any exceptions that occur when running the command and print an error message.\n\nHere's the updated code:\n```python\nimport subprocess\n\ndef print_date():\n    try:\n        result = subprocess.run([\"date\"], check=True)\n    except subprocess.CalledProcessError as e:\n        print(f\"Error: {e}\")\n    else:\n        print(result.stdout.decode(\"utf-8\"))\n\nprint_date()\n```\nNote that I've also added a `decode()` call to the output of `subprocess.run()`, since it returns bytes by default.",
    "analysis": "The issue is not just about importing the `subprocess` module, but also with how you're using it.\n\nIn your code, you have:\n```python\nimport subprocess\ndef print_date():\n    subprocess.run([\"date\"], check=True)\nprint_date()\n```\nThis will throw an error because `check=True` in `subprocess.run()` means that if the command returns a non-zero exit status, the function raises a `CalledProcessError`. However, you're not handling this exception.\n\nTo fix this issue, you need to handle the exception. Here's how you can do it:\n```python\nimport subprocess\n\ndef print_date():\n    try:\n        result = subprocess.run([\"date\"], check=True)\n    except subprocess.CalledProcessError as e:\n        print(f\"Error: {e}\")\n    else:\n        print(result.stdout.decode(\"utf-8\"))\n\nprint_date()\n```\nAlternatively, you can use the `shell` parameter to run the command in a shell. This allows you to write more complex commands using the shell syntax.\n```python\nimport subprocess\n\ndef print_date():\n    try:\n        result = subprocess.run([\"date\"], check=True, shell=True)\n    except subprocess.CalledProcessError as e:\n        print(f\"Error: {e}\")\n    else:\n        print(result.stdout.decode(\"utf-8\"))\n\nprint_date()\n```\nHowever, be aware that using `shell=True` can pose security risks if you're executing commands from untrusted sources.\n\nAnother alternative is to use the `run()` method with the `stdout` parameter set to `subprocess.PIPE`. This allows you to capture the output of the command.\n```python\nimport subprocess\n\ndef print_date():\n    try:\n        result = subprocess.run([\"date\"], check=True, stdout=subprocess.PIPE)\n    except subprocess.CalledProcessError as e:\n        print(f\"Error: {e}\")\n    else:\n        print(result.stdout.decode(\"utf-8\"))\n\nprint_date()\n```\nThis approach gives you more control over how the output of the command is handled."
  },
  {
    "id": "e5e12d67-54f1-4e5a-ac29-0539aaa74df1",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T07:09:04.336035+00:00",
    "logs": "Logs:\n{'print_date': '98afc59ad8de\\n INFO - ::group::Log message source details\\n*** Found local files:\\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T07:08:52.373746+00:00/task_id=print_date/attempt=1.log\\n INFO - ::endgroup::\\n[2025-04-14T07:08:57.798+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\\n[2025-04-14T07:08:57.824+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T07:08:52.373746+00:00 [queued]>\\n[2025-04-14T07:08:57.836+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T07:08:52.373746+00:00 [queued]>\\n[2025-04-14T07:08:57.837+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\\n[2025-04-14T07:08:57.853+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 07:08:52.373746+00:00\\n[2025-04-14T07:08:57.862+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=2302) is multi-threaded, use of fork() may lead to deadlocks in the child.\\n  pid = os.fork()\\n[2025-04-14T07:08:57.866+0000] {standard_task_runner.py:72} INFO - Started process 2304 to run task\\n[2025-04-14T07:08:57.866+0000] {standard_task_runner.py:104} INFO - Running: [\\'***\\', \\'tasks\\', \\'run\\', \\'modern_slack_notification_dag\\', \\'print_date\\', \\'manual__2025-04-14T07:08:52.373746+00:00\\', \\'--job-id\\', \\'142\\', \\'--raw\\', \\'--subdir\\', \\'DAGS_FOLDER/slack_notifier_dag.py\\', \\'--cfg-path\\', \\'/tmp/tmpdwxmbzfp\\']\\n[2025-04-14T07:08:57.868+0000] {standard_task_runner.py:105} INFO - Job 142: Subtask print_date\\n[2025-04-14T07:08:57.946+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T07:08:52.373746+00:00 [running]> on host 98afc59ad8de\\n[2025-04-14T07:08:58.079+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER=\\'***\\' AIRFLOW_CTX_DAG_ID=\\'modern_slack_notification_dag\\' AIRFLOW_CTX_TASK_ID=\\'print_date\\' AIRFLOW_CTX_EXECUTION_DATE=\\'2025-04-14T07:08:52.373746+00:00\\' AIRFLOW_CTX_TRY_NUMBER=\\'1\\' AIRFLOW_CTX_DAG_RUN_ID=\\'manual__2025-04-14T07:08:52.373746+00:00\\'\\n[2025-04-14T07:08:58.082+0000] {logging_mixin.py:190} INFO - Task instance is in running state\\n[2025-04-14T07:08:58.083+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\\n[2025-04-14T07:08:58.085+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 07:08:57.826267+00:00\\n[2025-04-14T07:08:58.087+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\\n[2025-04-14T07:08:58.088+0000] {taskinstance.py:732} INFO - ::endgroup::\\n[2025-04-14T07:08:58.091+0000] {taskinstance.py:3313} ERROR - Task failed with exception\\nTraceback (most recent call last):\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\\n    result = _execute_callable(context=context, **execute_callable_kwargs)\\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\\n    return ExecutionCallableRunner(\\n           ^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\\n    return self.func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\\n    return func(self, *args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\\n    return_value = super().execute(context)\\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\\n    return func(self, *args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\\n    return_value = self.execute_callable()\\n                   ^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\\n    return runner.run(*self.op_args, **self.op_kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\\n    return self.func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\\n    subprocess.run([\"date\"], check=True)\\n    ^^^^^^^^^^\\nNameError: name \\'subprocess\\' is not defined. Did you forget to import \\'subprocess\\'\\n[2025-04-14T07:08:58.131+0000] {logging_mixin.py:190} INFO - Task instance in failure state\\n[2025-04-14T07:08:58.132+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 07:08:57.826267+00:00 end:2025-04-14 07:08:58.130489+00:00 duration:0.304222\\n[2025-04-14T07:08:58.133+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 07:08:52.373746+00:00: manual__2025-04-14T07:08:52.373746+00:00, state:running, queued_at: 2025-04-14 07:08:52.428356+00:00. externally triggered: True>\\n[2025-04-14T07:08:58.135+0000] {logging_mixin.py:190} INFO - Failure caused by name \\'subprocess\\' is not defined\\n[2025-04-14T07:08:58.137+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T07:08:52.373746+00:00, execution_date=20250414T070852, start_date=20250414T070857, end_date=20250414T070858\\n[2025-04-14T07:08:58.208+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\\n[2025-04-14T07:08:58.209+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 142 for task print_date (name \\'subprocess\\' is not defined; 2304)\\nTraceback (most recent call last):\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\\n    ret = args.func(args, dag=self.dag)\\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\\n    return func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\\n    return f(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\\n    return _run_raw_task(args, ti)\\n           ^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\\n    return ti._run_raw_task(\\n           ^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\\n    return func(*args, session=session, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\\n    return _run_raw_task(\\n           ^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\\n    TaskInstance._execute_task_with_callbacks(\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\\n    result = self._execute_task(context, task_orig)\\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\\n    return _execute_task(self, context, task_orig)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\\n    result = _execute_callable(context=context, **execute_callable_kwargs)\\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\\n    return ExecutionCallableRunner(\\n           ^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\\n    return self.func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\\n    return func(self, *args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\\n    return_value = super().execute(context)\\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\\n    return func(self, *args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\\n    return_value = self.execute_callable()\\n                   ^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\\n    return runner.run(*self.op_args, **self.op_kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\\n    return self.func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\\n    subprocess.run([\"date\"], check=True)\\n    ^^^^^^^^^^\\nNameError: name \\'subprocess\\' is not defined. Did you forget to import \\'subprocess\\'\\n[2025-04-14T07:08:58.267+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\\n[2025-04-14T07:08:58.323+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\\n[2025-04-14T07:08:58.330+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\\n', 'sleep_task': 'default_host\\nError fetching the logs. Try number 0 is invalid.\\n'}\n\nAnalysis:\nThe issue here is that the `subprocess` module is not imported in your Python script.\n\nTo fix this, you need to add an import statement at the top of your script:\n```python\nimport subprocess\n```\nThis will allow you to use the `subprocess.run()` function to execute external commands.\n\nHere's an example of how your corrected code might look:\n```python\nimport subprocess\n\ndef print_date():\n    # ... (rest of your code remains the same)\n\n    result = subprocess.run([\"date\"], check=True)\n```\nAlternatively, you can also import only the `run` function from the `subprocess` module to avoid polluting the namespace:\n```python\nfrom subprocess import run\n\ndef print_date():\n    # ... (rest of your code remains the same)\n\n    result = run([\"date\"], check=True)\n```\nMake sure to add this import statement at the top of your script, and you should be able to use `subprocess.run()` without any issues.\n\nLog analysis complete. Results stored in log_analysis_output.txt",
    "analysis": "The issue here is that the `subprocess` module is not imported in your Python script.\n\nTo fix this, you need to add an import statement at the top of your script:\n```python\nimport subprocess\n```\nThis will allow you to use the `subprocess.run()` function to execute external commands.\n\nHere's an example of how your corrected code might look:\n```python\nimport subprocess\n\ndef print_date():\n    # ... (rest of your code remains the same)\n\n    result = subprocess.run([\"date\"], check=True)\n```\nAlternatively, you can also import only the `run` function from the `subprocess` module to avoid polluting the namespace:\n```python\nfrom subprocess import run\n\ndef print_date():\n    # ... (rest of your code remains the same)\n\n    result = run([\"date\"], check=True)\n```\nMake sure to add this import statement at the top of your script, and you should be able to use `subprocess.run()` without any issues.\n\nHere is a complete Python script that fixes the issue:\n```python\nimport subprocess\n\ndef print_date():\n    # Execute the date command using subprocess.run()\n    result = subprocess.run([\"date\"], check=True)\n\nprint_date()\n```\nThis script will execute the `date` command and print the output to the console."
  },
  {
    "id": "e9506f71-0e97-4180-a0ec-7f27a30368cd",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T06:59:24.643470+00:00",
    "response": "Logs:\n{'print_date': '98afc59ad8de\\n INFO - ::group::Log message source details\\n*** Found local files:\\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T06:59:10.038555+00:00/task_id=print_date/attempt=1.log\\n INFO - ::endgroup::\\n[2025-04-14T06:59:18.078+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\\n[2025-04-14T06:59:18.122+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T06:59:10.038555+00:00 [queued]>\\n[2025-04-14T06:59:18.150+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T06:59:10.038555+00:00 [queued]>\\n[2025-04-14T06:59:18.152+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\\n[2025-04-14T06:59:18.202+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 06:59:10.038555+00:00\\n[2025-04-14T06:59:18.220+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=2187) is multi-threaded, use of fork() may lead to deadlocks in the child.\\n  pid = os.fork()\\n[2025-04-14T06:59:18.225+0000] {standard_task_runner.py:72} INFO - Started process 2196 to run task\\n[2025-04-14T06:59:18.225+0000] {standard_task_runner.py:104} INFO - Running: [\\'***\\', \\'tasks\\', \\'run\\', \\'modern_slack_notification_dag\\', \\'print_date\\', \\'manual__2025-04-14T06:59:10.038555+00:00\\', \\'--job-id\\', \\'141\\', \\'--raw\\', \\'--subdir\\', \\'DAGS_FOLDER/slack_notifier_dag.py\\', \\'--cfg-path\\', \\'/tmp/tmpg3yc0vi1\\']\\n[2025-04-14T06:59:18.227+0000] {standard_task_runner.py:105} INFO - Job 141: Subtask print_date\\n[2025-04-14T06:59:18.378+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T06:59:10.038555+00:00 [running]> on host 98afc59ad8de\\n[2025-04-14T06:59:18.624+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER=\\'***\\' AIRFLOW_CTX_DAG_ID=\\'modern_slack_notification_dag\\' AIRFLOW_CTX_TASK_ID=\\'print_date\\' AIRFLOW_CTX_EXECUTION_DATE=\\'2025-04-14T06:59:10.038555+00:00\\' AIRFLOW_CTX_TRY_NUMBER=\\'1\\' AIRFLOW_CTX_DAG_RUN_ID=\\'manual__2025-04-14T06:59:10.038555+00:00\\'\\n[2025-04-14T06:59:18.633+0000] {logging_mixin.py:190} INFO - Task instance is in running state\\n[2025-04-14T06:59:18.638+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\\n[2025-04-14T06:59:18.639+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 06:59:18.123399+00:00\\n[2025-04-14T06:59:18.641+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\\n[2025-04-14T06:59:18.644+0000] {taskinstance.py:732} INFO - ::endgroup::\\n[2025-04-14T06:59:18.650+0000] {taskinstance.py:3313} ERROR - Task failed with exception\\nTraceback (most recent call last):\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\\n    result = _execute_callable(context=context, **execute_callable_kwargs)\\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\\n    return ExecutionCallableRunner(\\n           ^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\\n    return self.func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\\n    return func(self, *args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\\n    return_value = super().execute(context)\\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\\n    return func(self, *args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\\n    return_value = self.execute_callable()\\n                   ^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\\n    return runner.run(*self.op_args, **self.op_kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\\n    return self.func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\\n    subprocess.run([\"date\"], check=True)\\n    ^^^^^^^^^^\\nNameError: name \\'subprocess\\' is not defined. Did you forget to import \\'subprocess\\'\\n[2025-04-14T06:59:18.723+0000] {logging_mixin.py:190} INFO - Task instance in failure state\\n[2025-04-14T06:59:18.726+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 06:59:18.123399+00:00 end:2025-04-14 06:59:18.723243+00:00 duration:0.599844\\n[2025-04-14T06:59:18.727+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 06:59:10.038555+00:00: manual__2025-04-14T06:59:10.038555+00:00, state:running, queued_at: 2025-04-14 06:59:10.093476+00:00. externally triggered: True>\\n[2025-04-14T06:59:18.729+0000] {logging_mixin.py:190} INFO - Failure caused by name \\'subprocess\\' is not defined\\n[2025-04-14T06:59:18.731+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T06:59:10.038555+00:00, execution_date=20250414T065910, start_date=20250414T065918, end_date=20250414T065918\\n[2025-04-14T06:59:18.824+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\\n[2025-04-14T06:59:18.827+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 141 for task print_date (name \\'subprocess\\' is not defined; 2196)\\nTraceback (most recent call last):\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\\n    ret = args.func(args, dag=self.dag)\\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\\n    return func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\\n    return f(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\\n    return _run_raw_task(args, ti)\\n           ^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\\n    return ti._run_raw_task(\\n           ^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\\n    return func(*args, session=session, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\\n    return _run_raw_task(\\n           ^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\\n    TaskInstance._execute_task_with_callbacks(\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\\n    result = self._execute_task(context, task_orig)\\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\\n    return _execute_task(self, context, task_orig)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\\n    result = _execute_callable(context=context, **execute_callable_kwargs)\\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\\n    return ExecutionCallableRunner(\\n           ^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\\n    return self.func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\\n    return func(self, *args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\\n    return_value = super().execute(context)\\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\\n    return func(self, *args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\\n    return_value = self.execute_callable()\\n                   ^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\\n    return runner.run(*self.op_args, **self.op_kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\\n    return self.func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\\n    subprocess.run([\"date\"], check=True)\\n    ^^^^^^^^^^\\nNameError: name \\'subprocess\\' is not defined. Did you forget to import \\'subprocess\\'\\n[2025-04-14T06:59:18.893+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\\n[2025-04-14T06:59:18.967+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\\n[2025-04-14T06:59:18.979+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\\n', 'sleep_task': 'default_host\\nError fetching the logs. Try number 0 is invalid.\\n'}\n\nAnalysis:\nThe issue here is that you're trying to use `subprocess.run` without importing it from the `subprocess` module.\n\nTo fix this, simply add the following line at the top of your Python file:\n```python\nimport subprocess\n```\nAlternatively, if you're using a newer version of Python (3.8+), you can import `run` directly from the `subprocess` module without having to use `subprocess.run` explicitly:\n```python\nfrom subprocess import run\n```\nThen, in your code, you can simply use `run([\"date\"], check=True)`.\n\nHere's an example of how your corrected code might look:\n```python\nimport subprocess\n\ndef print_date():\n    try:\n        subprocess.run([\"date\"], check=True)\n    except subprocess.CalledProcessError as e:\n        print(f\"Error: {e}\")\n\nprint_date()\n```\nNote that I've also added a `try`-`except` block to catch any errors that might occur when running the command. This is good practice when working with external commands, as it allows you to handle any unexpected behavior or errors that might arise.\n\nLog analysis complete. Results stored in log_analysis_output.txt"
  },
  {
    "id": "f2f605c8-6004-460e-893c-b4e6d9e67c2f",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T06:46:38.878094+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T06:46:27.131014+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T06:46:32.001+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T06:46:32.034+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T06:46:27.131014+00:00 [queued]>\n[2025-04-14T06:46:32.050+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T06:46:27.131014+00:00 [queued]>\n[2025-04-14T06:46:32.051+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T06:46:32.072+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 06:46:27.131014+00:00\n[2025-04-14T06:46:32.085+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=2034) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T06:46:32.088+0000] {standard_task_runner.py:72} INFO - Started process 2036 to run task\n[2025-04-14T06:46:32.089+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T06:46:27.131014+00:00', '--job-id', '140', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpadfsn2rk']\n[2025-04-14T06:46:32.093+0000] {standard_task_runner.py:105} INFO - Job 140: Subtask print_date\n[2025-04-14T06:46:32.204+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T06:46:27.131014+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T06:46:32.356+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T06:46:27.131014+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T06:46:27.131014+00:00'\n[2025-04-14T06:46:32.358+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T06:46:32.359+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T06:46:32.361+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 06:46:32.037051+00:00\n[2025-04-14T06:46:32.362+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T06:46:32.363+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T06:46:32.365+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T06:46:32.399+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T06:46:32.400+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 06:46:32.037051+00:00 end:2025-04-14 06:46:32.399310+00:00 duration:0.362259\n[2025-04-14T06:46:32.401+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 06:46:27.131014+00:00: manual__2025-04-14T06:46:27.131014+00:00, state:running, queued_at: 2025-04-14 06:46:27.210241+00:00. externally triggered: True>\n[2025-04-14T06:46:32.402+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T06:46:32.403+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T06:46:27.131014+00:00, execution_date=20250414T064627, start_date=20250414T064632, end_date=20250414T064632\n[2025-04-14T06:46:32.452+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T06:46:32.453+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 140 for task print_date (name 'subprocess' is not defined; 2036)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T06:46:32.494+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T06:46:32.540+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T06:46:32.547+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "32053334-6bf9-435b-be5e-75cdf5a2cfb5",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T06:44:16.247831+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T06:44:05.443601+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T06:44:10.549+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T06:44:10.579+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T06:44:05.443601+00:00 [queued]>\n[2025-04-14T06:44:10.596+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T06:44:05.443601+00:00 [queued]>\n[2025-04-14T06:44:10.597+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T06:44:10.619+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 06:44:05.443601+00:00\n[2025-04-14T06:44:10.630+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=2010) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T06:44:10.633+0000] {standard_task_runner.py:72} INFO - Started process 2012 to run task\n[2025-04-14T06:44:10.633+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T06:44:05.443601+00:00', '--job-id', '139', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpd09e5uhs']\n[2025-04-14T06:44:10.638+0000] {standard_task_runner.py:105} INFO - Job 139: Subtask print_date\n[2025-04-14T06:44:10.736+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T06:44:05.443601+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T06:44:10.874+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T06:44:05.443601+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T06:44:05.443601+00:00'\n[2025-04-14T06:44:10.878+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T06:44:10.880+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T06:44:10.882+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 06:44:10.581400+00:00\n[2025-04-14T06:44:10.885+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T06:44:10.887+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T06:44:10.891+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T06:44:10.926+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T06:44:10.927+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 06:44:10.581400+00:00 end:2025-04-14 06:44:10.925771+00:00 duration:0.344371\n[2025-04-14T06:44:10.931+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 06:44:05.443601+00:00: manual__2025-04-14T06:44:05.443601+00:00, state:running, queued_at: 2025-04-14 06:44:05.469967+00:00. externally triggered: True>\n[2025-04-14T06:44:10.933+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T06:44:10.936+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T06:44:05.443601+00:00, execution_date=20250414T064405, start_date=20250414T064410, end_date=20250414T064410\n[2025-04-14T06:44:10.995+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T06:44:10.997+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 139 for task print_date (name 'subprocess' is not defined; 2012)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T06:44:11.030+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T06:44:11.075+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T06:44:11.092+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "c443f3ec-6fd4-402b-b54e-7624b1144a2e",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T05:49:43.324740+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T05:49:29.208056+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T05:49:37.063+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T05:49:37.112+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:49:29.208056+00:00 [queued]>\n[2025-04-14T05:49:37.138+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:49:29.208056+00:00 [queued]>\n[2025-04-14T05:49:37.142+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T05:49:37.172+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 05:49:29.208056+00:00\n[2025-04-14T05:49:37.198+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=1317) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T05:49:37.203+0000] {standard_task_runner.py:72} INFO - Started process 1319 to run task\n[2025-04-14T05:49:37.203+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T05:49:29.208056+00:00', '--job-id', '127', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpnmoboobb']\n[2025-04-14T05:49:37.206+0000] {standard_task_runner.py:105} INFO - Job 127: Subtask print_date\n[2025-04-14T05:49:37.310+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:49:29.208056+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T05:49:37.563+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T05:49:29.208056+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T05:49:29.208056+00:00'\n[2025-04-14T05:49:37.571+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T05:49:37.573+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T05:49:37.577+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 05:49:37.113600+00:00\n[2025-04-14T05:49:37.578+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T05:49:37.580+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T05:49:37.591+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:49:37.641+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T05:49:37.642+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 05:49:37.113600+00:00 end:2025-04-14 05:49:37.640142+00:00 duration:0.526542\n[2025-04-14T05:49:37.647+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 05:49:29.208056+00:00: manual__2025-04-14T05:49:29.208056+00:00, state:running, queued_at: 2025-04-14 05:49:29.245646+00:00. externally triggered: True>\n[2025-04-14T05:49:37.649+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T05:49:37.654+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T05:49:29.208056+00:00, execution_date=20250414T054929, start_date=20250414T054937, end_date=20250414T054937\n[2025-04-14T05:49:37.734+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T05:49:37.738+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 127 for task print_date (name 'subprocess' is not defined; 1319)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:49:37.810+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T05:49:37.902+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T05:49:37.911+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "0bdd933c-ba77-4e8c-9cc1-942a1cc094e0",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T05:47:09.611704+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T05:46:53.750071+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T05:47:03.313+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T05:47:03.391+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:46:53.750071+00:00 [queued]>\n[2025-04-14T05:47:03.409+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:46:53.750071+00:00 [queued]>\n[2025-04-14T05:47:03.410+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T05:47:03.438+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 05:46:53.750071+00:00\n[2025-04-14T05:47:03.456+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=1286) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T05:47:03.460+0000] {standard_task_runner.py:72} INFO - Started process 1288 to run task\n[2025-04-14T05:47:03.469+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T05:46:53.750071+00:00', '--job-id', '126', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpa8ma7e3w']\n[2025-04-14T05:47:03.472+0000] {standard_task_runner.py:105} INFO - Job 126: Subtask print_date\n[2025-04-14T05:47:03.700+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:46:53.750071+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T05:47:04.065+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T05:46:53.750071+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T05:46:53.750071+00:00'\n[2025-04-14T05:47:04.069+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T05:47:04.070+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T05:47:04.072+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 05:47:03.392560+00:00\n[2025-04-14T05:47:04.077+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T05:47:04.079+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T05:47:04.083+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:47:04.139+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T05:47:04.141+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 05:47:03.392560+00:00 end:2025-04-14 05:47:04.138127+00:00 duration:0.745567\n[2025-04-14T05:47:04.142+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 05:46:53.750071+00:00: manual__2025-04-14T05:46:53.750071+00:00, state:running, queued_at: 2025-04-14 05:46:53.899802+00:00. externally triggered: True>\n[2025-04-14T05:47:04.146+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T05:47:04.148+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T05:46:53.750071+00:00, execution_date=20250414T054653, start_date=20250414T054703, end_date=20250414T054704\n[2025-04-14T05:47:04.237+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T05:47:04.241+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 126 for task print_date (name 'subprocess' is not defined; 1288)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:47:04.300+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T05:47:04.372+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T05:47:04.386+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "c9ef8cfe-0897-496c-9781-7230a7b70b8c",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T05:42:52.000731+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T05:36:28.466684+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T05:36:35.068+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T05:36:35.108+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:36:28.466684+00:00 [queued]>\n[2025-04-14T05:36:35.137+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:36:28.466684+00:00 [queued]>\n[2025-04-14T05:36:35.141+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T05:36:35.189+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 05:36:28.466684+00:00\n[2025-04-14T05:36:35.201+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=1164) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T05:36:35.204+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T05:36:28.466684+00:00', '--job-id', '125', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpork3ffiz']\n[2025-04-14T05:36:35.205+0000] {standard_task_runner.py:72} INFO - Started process 1166 to run task\n[2025-04-14T05:36:35.210+0000] {standard_task_runner.py:105} INFO - Job 125: Subtask print_date\n[2025-04-14T05:36:35.310+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:36:28.466684+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T05:36:35.448+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T05:36:28.466684+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T05:36:28.466684+00:00'\n[2025-04-14T05:36:35.450+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T05:36:35.451+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T05:36:35.452+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 05:36:35.109494+00:00\n[2025-04-14T05:36:35.453+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T05:36:35.457+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T05:36:35.460+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:36:35.490+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T05:36:35.491+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 05:36:35.109494+00:00 end:2025-04-14 05:36:35.489923+00:00 duration:0.380429\n[2025-04-14T05:36:35.492+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 05:36:28.466684+00:00: manual__2025-04-14T05:36:28.466684+00:00, state:running, queued_at: 2025-04-14 05:36:28.534776+00:00. externally triggered: True>\n[2025-04-14T05:36:35.493+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T05:36:35.494+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T05:36:28.466684+00:00, execution_date=20250414T053628, start_date=20250414T053635, end_date=20250414T053635\n[2025-04-14T05:36:35.544+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T05:36:35.546+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 125 for task print_date (name 'subprocess' is not defined; 1166)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:36:35.575+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T05:36:35.620+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T05:36:35.628+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "36bda7a0-2969-4462-a61d-92bc1a17349e",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T05:37:48.333370+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T05:36:28.466684+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T05:36:35.068+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T05:36:35.108+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:36:28.466684+00:00 [queued]>\n[2025-04-14T05:36:35.137+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:36:28.466684+00:00 [queued]>\n[2025-04-14T05:36:35.141+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T05:36:35.189+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 05:36:28.466684+00:00\n[2025-04-14T05:36:35.201+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=1164) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T05:36:35.204+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T05:36:28.466684+00:00', '--job-id', '125', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpork3ffiz']\n[2025-04-14T05:36:35.205+0000] {standard_task_runner.py:72} INFO - Started process 1166 to run task\n[2025-04-14T05:36:35.210+0000] {standard_task_runner.py:105} INFO - Job 125: Subtask print_date\n[2025-04-14T05:36:35.310+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:36:28.466684+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T05:36:35.448+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T05:36:28.466684+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T05:36:28.466684+00:00'\n[2025-04-14T05:36:35.450+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T05:36:35.451+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T05:36:35.452+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 05:36:35.109494+00:00\n[2025-04-14T05:36:35.453+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T05:36:35.457+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T05:36:35.460+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:36:35.490+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T05:36:35.491+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 05:36:35.109494+00:00 end:2025-04-14 05:36:35.489923+00:00 duration:0.380429\n[2025-04-14T05:36:35.492+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 05:36:28.466684+00:00: manual__2025-04-14T05:36:28.466684+00:00, state:running, queued_at: 2025-04-14 05:36:28.534776+00:00. externally triggered: True>\n[2025-04-14T05:36:35.493+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T05:36:35.494+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T05:36:28.466684+00:00, execution_date=20250414T053628, start_date=20250414T053635, end_date=20250414T053635\n[2025-04-14T05:36:35.544+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T05:36:35.546+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 125 for task print_date (name 'subprocess' is not defined; 1166)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:36:35.575+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T05:36:35.620+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T05:36:35.628+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "ee8ac42e-7adf-4dc0-8413-b570974d3f65",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T05:36:44.040788+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T05:36:28.466684+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T05:36:35.068+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T05:36:35.108+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:36:28.466684+00:00 [queued]>\n[2025-04-14T05:36:35.137+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:36:28.466684+00:00 [queued]>\n[2025-04-14T05:36:35.141+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T05:36:35.189+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 05:36:28.466684+00:00\n[2025-04-14T05:36:35.201+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=1164) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T05:36:35.204+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T05:36:28.466684+00:00', '--job-id', '125', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpork3ffiz']\n[2025-04-14T05:36:35.205+0000] {standard_task_runner.py:72} INFO - Started process 1166 to run task\n[2025-04-14T05:36:35.210+0000] {standard_task_runner.py:105} INFO - Job 125: Subtask print_date\n[2025-04-14T05:36:35.310+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:36:28.466684+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T05:36:35.448+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T05:36:28.466684+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T05:36:28.466684+00:00'\n[2025-04-14T05:36:35.450+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T05:36:35.451+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T05:36:35.452+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 05:36:35.109494+00:00\n[2025-04-14T05:36:35.453+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T05:36:35.457+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T05:36:35.460+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:36:35.490+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T05:36:35.491+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 05:36:35.109494+00:00 end:2025-04-14 05:36:35.489923+00:00 duration:0.380429\n[2025-04-14T05:36:35.492+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 05:36:28.466684+00:00: manual__2025-04-14T05:36:28.466684+00:00, state:running, queued_at: 2025-04-14 05:36:28.534776+00:00. externally triggered: True>\n[2025-04-14T05:36:35.493+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T05:36:35.494+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T05:36:28.466684+00:00, execution_date=20250414T053628, start_date=20250414T053635, end_date=20250414T053635\n[2025-04-14T05:36:35.544+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T05:36:35.546+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 125 for task print_date (name 'subprocess' is not defined; 1166)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:36:35.575+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T05:36:35.620+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T05:36:35.628+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "31c2194e-639e-45ab-8eb7-c0496e50ee4c",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T05:36:40.305377+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T05:36:28.466684+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T05:36:35.068+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T05:36:35.108+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:36:28.466684+00:00 [queued]>\n[2025-04-14T05:36:35.137+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:36:28.466684+00:00 [queued]>\n[2025-04-14T05:36:35.141+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T05:36:35.189+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 05:36:28.466684+00:00\n[2025-04-14T05:36:35.201+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=1164) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T05:36:35.204+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T05:36:28.466684+00:00', '--job-id', '125', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpork3ffiz']\n[2025-04-14T05:36:35.205+0000] {standard_task_runner.py:72} INFO - Started process 1166 to run task\n[2025-04-14T05:36:35.210+0000] {standard_task_runner.py:105} INFO - Job 125: Subtask print_date\n[2025-04-14T05:36:35.310+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:36:28.466684+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T05:36:35.448+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T05:36:28.466684+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T05:36:28.466684+00:00'\n[2025-04-14T05:36:35.450+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T05:36:35.451+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T05:36:35.452+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 05:36:35.109494+00:00\n[2025-04-14T05:36:35.453+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T05:36:35.457+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T05:36:35.460+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:36:35.490+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T05:36:35.491+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 05:36:35.109494+00:00 end:2025-04-14 05:36:35.489923+00:00 duration:0.380429\n[2025-04-14T05:36:35.492+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 05:36:28.466684+00:00: manual__2025-04-14T05:36:28.466684+00:00, state:running, queued_at: 2025-04-14 05:36:28.534776+00:00. externally triggered: True>\n[2025-04-14T05:36:35.493+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T05:36:35.494+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T05:36:28.466684+00:00, execution_date=20250414T053628, start_date=20250414T053635, end_date=20250414T053635\n[2025-04-14T05:36:35.544+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T05:36:35.546+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 125 for task print_date (name 'subprocess' is not defined; 1166)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:36:35.575+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T05:36:35.620+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T05:36:35.628+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "196d4ae2-c9ff-4413-b95c-4066a1cd5b39",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T05:27:03.783382+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T05:20:36.804619+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T05:20:46.358+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T05:20:46.414+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:20:36.804619+00:00 [queued]>\n[2025-04-14T05:20:46.437+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:20:36.804619+00:00 [queued]>\n[2025-04-14T05:20:46.438+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T05:20:46.471+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 05:20:36.804619+00:00\n[2025-04-14T05:20:46.490+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=977) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T05:20:46.493+0000] {standard_task_runner.py:72} INFO - Started process 986 to run task\n[2025-04-14T05:20:46.497+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T05:20:36.804619+00:00', '--job-id', '124', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpnp6mau1g']\n[2025-04-14T05:20:46.501+0000] {standard_task_runner.py:105} INFO - Job 124: Subtask print_date\n[2025-04-14T05:20:46.680+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:20:36.804619+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T05:20:46.934+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T05:20:36.804619+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T05:20:36.804619+00:00'\n[2025-04-14T05:20:46.937+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T05:20:46.938+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T05:20:46.939+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 05:20:46.417488+00:00\n[2025-04-14T05:20:46.942+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T05:20:46.944+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T05:20:46.947+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:20:47.020+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T05:20:47.021+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 05:20:46.417488+00:00 end:2025-04-14 05:20:47.019477+00:00 duration:0.601989\n[2025-04-14T05:20:47.025+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 05:20:36.804619+00:00: manual__2025-04-14T05:20:36.804619+00:00, state:running, queued_at: 2025-04-14 05:20:36.920211+00:00. externally triggered: True>\n[2025-04-14T05:20:47.033+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T05:20:47.034+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T05:20:36.804619+00:00, execution_date=20250414T052036, start_date=20250414T052046, end_date=20250414T052047\n[2025-04-14T05:20:47.288+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T05:20:47.311+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 124 for task print_date (name 'subprocess' is not defined; 986)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:20:47.415+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T05:20:47.507+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T05:20:47.534+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "b9e37a32-6ce9-4c17-8dd5-05fa8124b2f0",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T05:22:00.024653+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T05:20:36.804619+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T05:20:46.358+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T05:20:46.414+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:20:36.804619+00:00 [queued]>\n[2025-04-14T05:20:46.437+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:20:36.804619+00:00 [queued]>\n[2025-04-14T05:20:46.438+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T05:20:46.471+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 05:20:36.804619+00:00\n[2025-04-14T05:20:46.490+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=977) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T05:20:46.493+0000] {standard_task_runner.py:72} INFO - Started process 986 to run task\n[2025-04-14T05:20:46.497+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T05:20:36.804619+00:00', '--job-id', '124', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpnp6mau1g']\n[2025-04-14T05:20:46.501+0000] {standard_task_runner.py:105} INFO - Job 124: Subtask print_date\n[2025-04-14T05:20:46.680+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:20:36.804619+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T05:20:46.934+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T05:20:36.804619+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T05:20:36.804619+00:00'\n[2025-04-14T05:20:46.937+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T05:20:46.938+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T05:20:46.939+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 05:20:46.417488+00:00\n[2025-04-14T05:20:46.942+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T05:20:46.944+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T05:20:46.947+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:20:47.020+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T05:20:47.021+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 05:20:46.417488+00:00 end:2025-04-14 05:20:47.019477+00:00 duration:0.601989\n[2025-04-14T05:20:47.025+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 05:20:36.804619+00:00: manual__2025-04-14T05:20:36.804619+00:00, state:running, queued_at: 2025-04-14 05:20:36.920211+00:00. externally triggered: True>\n[2025-04-14T05:20:47.033+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T05:20:47.034+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T05:20:36.804619+00:00, execution_date=20250414T052036, start_date=20250414T052046, end_date=20250414T052047\n[2025-04-14T05:20:47.288+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T05:20:47.311+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 124 for task print_date (name 'subprocess' is not defined; 986)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:20:47.415+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T05:20:47.507+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T05:20:47.534+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "b8566456-5007-47d9-b915-146a7986d5fd",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T05:20:53.288549+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T05:20:36.804619+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T05:20:46.358+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T05:20:46.414+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:20:36.804619+00:00 [queued]>\n[2025-04-14T05:20:46.437+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:20:36.804619+00:00 [queued]>\n[2025-04-14T05:20:46.438+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T05:20:46.471+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 05:20:36.804619+00:00\n[2025-04-14T05:20:46.490+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=977) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T05:20:46.493+0000] {standard_task_runner.py:72} INFO - Started process 986 to run task\n[2025-04-14T05:20:46.497+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T05:20:36.804619+00:00', '--job-id', '124', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpnp6mau1g']\n[2025-04-14T05:20:46.501+0000] {standard_task_runner.py:105} INFO - Job 124: Subtask print_date\n[2025-04-14T05:20:46.680+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:20:36.804619+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T05:20:46.934+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T05:20:36.804619+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T05:20:36.804619+00:00'\n[2025-04-14T05:20:46.937+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T05:20:46.938+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T05:20:46.939+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 05:20:46.417488+00:00\n[2025-04-14T05:20:46.942+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T05:20:46.944+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T05:20:46.947+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:20:47.020+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T05:20:47.021+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 05:20:46.417488+00:00 end:2025-04-14 05:20:47.019477+00:00 duration:0.601989\n[2025-04-14T05:20:47.025+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 05:20:36.804619+00:00: manual__2025-04-14T05:20:36.804619+00:00, state:running, queued_at: 2025-04-14 05:20:36.920211+00:00. externally triggered: True>\n[2025-04-14T05:20:47.033+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T05:20:47.034+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T05:20:36.804619+00:00, execution_date=20250414T052036, start_date=20250414T052046, end_date=20250414T052047\n[2025-04-14T05:20:47.288+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T05:20:47.311+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 124 for task print_date (name 'subprocess' is not defined; 986)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:20:47.415+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T05:20:47.507+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T05:20:47.534+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "c9d6758b-9f2a-4b60-a193-f164b0f1a64c",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T05:20:56.680509+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T05:20:36.804619+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T05:20:46.358+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T05:20:46.414+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:20:36.804619+00:00 [queued]>\n[2025-04-14T05:20:46.437+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:20:36.804619+00:00 [queued]>\n[2025-04-14T05:20:46.438+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T05:20:46.471+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 05:20:36.804619+00:00\n[2025-04-14T05:20:46.490+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=977) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T05:20:46.493+0000] {standard_task_runner.py:72} INFO - Started process 986 to run task\n[2025-04-14T05:20:46.497+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T05:20:36.804619+00:00', '--job-id', '124', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpnp6mau1g']\n[2025-04-14T05:20:46.501+0000] {standard_task_runner.py:105} INFO - Job 124: Subtask print_date\n[2025-04-14T05:20:46.680+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:20:36.804619+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T05:20:46.934+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T05:20:36.804619+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T05:20:36.804619+00:00'\n[2025-04-14T05:20:46.937+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T05:20:46.938+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T05:20:46.939+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 05:20:46.417488+00:00\n[2025-04-14T05:20:46.942+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T05:20:46.944+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T05:20:46.947+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:20:47.020+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T05:20:47.021+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 05:20:46.417488+00:00 end:2025-04-14 05:20:47.019477+00:00 duration:0.601989\n[2025-04-14T05:20:47.025+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 05:20:36.804619+00:00: manual__2025-04-14T05:20:36.804619+00:00, state:running, queued_at: 2025-04-14 05:20:36.920211+00:00. externally triggered: True>\n[2025-04-14T05:20:47.033+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T05:20:47.034+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T05:20:36.804619+00:00, execution_date=20250414T052036, start_date=20250414T052046, end_date=20250414T052047\n[2025-04-14T05:20:47.288+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T05:20:47.311+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 124 for task print_date (name 'subprocess' is not defined; 986)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:20:47.415+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T05:20:47.507+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T05:20:47.534+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "d85542a6-9565-4359-9c4e-8924bc2e57a8",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T05:15:55.334422+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T05:09:28.083792+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T05:09:38.180+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T05:09:38.397+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:09:28.083792+00:00 [queued]>\n[2025-04-14T05:09:38.426+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:09:28.083792+00:00 [queued]>\n[2025-04-14T05:09:38.430+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T05:09:38.483+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 05:09:28.083792+00:00\n[2025-04-14T05:09:38.561+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=855) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T05:09:38.584+0000] {standard_task_runner.py:72} INFO - Started process 857 to run task\n[2025-04-14T05:09:38.689+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T05:09:28.083792+00:00', '--job-id', '123', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpqoyp2xet']\n[2025-04-14T05:09:38.700+0000] {standard_task_runner.py:105} INFO - Job 123: Subtask print_date\n[2025-04-14T05:09:39.270+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:09:28.083792+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T05:09:39.544+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T05:09:28.083792+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T05:09:28.083792+00:00'\n[2025-04-14T05:09:39.553+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T05:09:39.555+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T05:09:39.558+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 05:09:38.401229+00:00\n[2025-04-14T05:09:39.560+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T05:09:39.561+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T05:09:39.563+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:09:39.638+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T05:09:39.641+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 05:09:38.401229+00:00 end:2025-04-14 05:09:39.637272+00:00 duration:1.236043\n[2025-04-14T05:09:39.642+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 05:09:28.083792+00:00: manual__2025-04-14T05:09:28.083792+00:00, state:running, queued_at: 2025-04-14 05:09:28.378482+00:00. externally triggered: True>\n[2025-04-14T05:09:39.644+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T05:09:39.646+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T05:09:28.083792+00:00, execution_date=20250414T050928, start_date=20250414T050938, end_date=20250414T050939\n[2025-04-14T05:09:39.714+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T05:09:39.716+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 123 for task print_date (name 'subprocess' is not defined; 857)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:09:39.771+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T05:09:39.840+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T05:09:39.852+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "8e3857da-3737-49ab-ade1-d46236b234c4",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T05:10:51.950149+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T05:09:28.083792+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T05:09:38.180+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T05:09:38.397+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:09:28.083792+00:00 [queued]>\n[2025-04-14T05:09:38.426+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:09:28.083792+00:00 [queued]>\n[2025-04-14T05:09:38.430+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T05:09:38.483+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 05:09:28.083792+00:00\n[2025-04-14T05:09:38.561+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=855) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T05:09:38.584+0000] {standard_task_runner.py:72} INFO - Started process 857 to run task\n[2025-04-14T05:09:38.689+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T05:09:28.083792+00:00', '--job-id', '123', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpqoyp2xet']\n[2025-04-14T05:09:38.700+0000] {standard_task_runner.py:105} INFO - Job 123: Subtask print_date\n[2025-04-14T05:09:39.270+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:09:28.083792+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T05:09:39.544+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T05:09:28.083792+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T05:09:28.083792+00:00'\n[2025-04-14T05:09:39.553+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T05:09:39.555+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T05:09:39.558+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 05:09:38.401229+00:00\n[2025-04-14T05:09:39.560+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T05:09:39.561+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T05:09:39.563+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:09:39.638+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T05:09:39.641+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 05:09:38.401229+00:00 end:2025-04-14 05:09:39.637272+00:00 duration:1.236043\n[2025-04-14T05:09:39.642+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 05:09:28.083792+00:00: manual__2025-04-14T05:09:28.083792+00:00, state:running, queued_at: 2025-04-14 05:09:28.378482+00:00. externally triggered: True>\n[2025-04-14T05:09:39.644+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T05:09:39.646+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T05:09:28.083792+00:00, execution_date=20250414T050928, start_date=20250414T050938, end_date=20250414T050939\n[2025-04-14T05:09:39.714+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T05:09:39.716+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 123 for task print_date (name 'subprocess' is not defined; 857)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:09:39.771+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T05:09:39.840+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T05:09:39.852+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "580c6400-945b-438b-8843-0660ba257150",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T05:09:45.324235+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T05:09:28.083792+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T05:09:38.180+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T05:09:38.397+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:09:28.083792+00:00 [queued]>\n[2025-04-14T05:09:38.426+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:09:28.083792+00:00 [queued]>\n[2025-04-14T05:09:38.430+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T05:09:38.483+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 05:09:28.083792+00:00\n[2025-04-14T05:09:38.561+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=855) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T05:09:38.584+0000] {standard_task_runner.py:72} INFO - Started process 857 to run task\n[2025-04-14T05:09:38.689+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T05:09:28.083792+00:00', '--job-id', '123', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpqoyp2xet']\n[2025-04-14T05:09:38.700+0000] {standard_task_runner.py:105} INFO - Job 123: Subtask print_date\n[2025-04-14T05:09:39.270+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:09:28.083792+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T05:09:39.544+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T05:09:28.083792+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T05:09:28.083792+00:00'\n[2025-04-14T05:09:39.553+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T05:09:39.555+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T05:09:39.558+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 05:09:38.401229+00:00\n[2025-04-14T05:09:39.560+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T05:09:39.561+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T05:09:39.563+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:09:39.638+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T05:09:39.641+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 05:09:38.401229+00:00 end:2025-04-14 05:09:39.637272+00:00 duration:1.236043\n[2025-04-14T05:09:39.642+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 05:09:28.083792+00:00: manual__2025-04-14T05:09:28.083792+00:00, state:running, queued_at: 2025-04-14 05:09:28.378482+00:00. externally triggered: True>\n[2025-04-14T05:09:39.644+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T05:09:39.646+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T05:09:28.083792+00:00, execution_date=20250414T050928, start_date=20250414T050938, end_date=20250414T050939\n[2025-04-14T05:09:39.714+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T05:09:39.716+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 123 for task print_date (name 'subprocess' is not defined; 857)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:09:39.771+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T05:09:39.840+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T05:09:39.852+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "4d484709-ec35-4739-90b5-5b9e7ede43ca",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T05:09:48.579808+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T05:09:28.083792+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T05:09:38.180+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T05:09:38.397+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:09:28.083792+00:00 [queued]>\n[2025-04-14T05:09:38.426+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:09:28.083792+00:00 [queued]>\n[2025-04-14T05:09:38.430+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T05:09:38.483+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 05:09:28.083792+00:00\n[2025-04-14T05:09:38.561+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=855) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T05:09:38.584+0000] {standard_task_runner.py:72} INFO - Started process 857 to run task\n[2025-04-14T05:09:38.689+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T05:09:28.083792+00:00', '--job-id', '123', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpqoyp2xet']\n[2025-04-14T05:09:38.700+0000] {standard_task_runner.py:105} INFO - Job 123: Subtask print_date\n[2025-04-14T05:09:39.270+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T05:09:28.083792+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T05:09:39.544+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T05:09:28.083792+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T05:09:28.083792+00:00'\n[2025-04-14T05:09:39.553+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T05:09:39.555+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T05:09:39.558+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 05:09:38.401229+00:00\n[2025-04-14T05:09:39.560+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T05:09:39.561+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T05:09:39.563+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:09:39.638+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T05:09:39.641+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 05:09:38.401229+00:00 end:2025-04-14 05:09:39.637272+00:00 duration:1.236043\n[2025-04-14T05:09:39.642+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 05:09:28.083792+00:00: manual__2025-04-14T05:09:28.083792+00:00, state:running, queued_at: 2025-04-14 05:09:28.378482+00:00. externally triggered: True>\n[2025-04-14T05:09:39.644+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T05:09:39.646+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T05:09:28.083792+00:00, execution_date=20250414T050928, start_date=20250414T050938, end_date=20250414T050939\n[2025-04-14T05:09:39.714+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T05:09:39.716+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 123 for task print_date (name 'subprocess' is not defined; 857)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T05:09:39.771+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T05:09:39.840+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T05:09:39.852+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "b2e30c2b-6319-4753-8908-d4e86c606d63",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T04:22:48.126441+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T04:16:23.390985+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T04:16:30.361+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T04:16:30.407+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T04:16:23.390985+00:00 [queued]>\n[2025-04-14T04:16:30.807+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T04:16:23.390985+00:00 [queued]>\n[2025-04-14T04:16:30.809+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T04:16:30.899+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 04:16:23.390985+00:00\n[2025-04-14T04:16:30.921+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=212) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T04:16:30.927+0000] {standard_task_runner.py:72} INFO - Started process 221 to run task\n[2025-04-14T04:16:30.939+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T04:16:23.390985+00:00', '--job-id', '122', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpiwggfcew']\n[2025-04-14T04:16:30.949+0000] {standard_task_runner.py:105} INFO - Job 122: Subtask print_date\n[2025-04-14T04:16:31.082+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T04:16:23.390985+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T04:16:31.297+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T04:16:23.390985+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T04:16:23.390985+00:00'\n[2025-04-14T04:16:31.302+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T04:16:31.303+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T04:16:31.305+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 04:16:30.409130+00:00\n[2025-04-14T04:16:31.308+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T04:16:31.313+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T04:16:31.316+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T04:16:31.357+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T04:16:31.359+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 04:16:30.409130+00:00 end:2025-04-14 04:16:31.357148+00:00 duration:0.948018\n[2025-04-14T04:16:31.361+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 04:16:23.390985+00:00: manual__2025-04-14T04:16:23.390985+00:00, state:running, queued_at: 2025-04-14 04:16:23.496059+00:00. externally triggered: True>\n[2025-04-14T04:16:31.362+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T04:16:31.366+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T04:16:23.390985+00:00, execution_date=20250414T041623, start_date=20250414T041630, end_date=20250414T041631\n[2025-04-14T04:16:31.432+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T04:16:31.434+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 122 for task print_date (name 'subprocess' is not defined; 221)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T04:16:31.471+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T04:16:31.521+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T04:16:31.531+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "95fd5bb6-08fd-4080-868c-8e07c64c79cc",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T04:18:00.220962+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T04:16:23.390985+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T04:16:30.361+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T04:16:30.407+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T04:16:23.390985+00:00 [queued]>\n[2025-04-14T04:16:30.807+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T04:16:23.390985+00:00 [queued]>\n[2025-04-14T04:16:30.809+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T04:16:30.899+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 04:16:23.390985+00:00\n[2025-04-14T04:16:30.921+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=212) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T04:16:30.927+0000] {standard_task_runner.py:72} INFO - Started process 221 to run task\n[2025-04-14T04:16:30.939+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T04:16:23.390985+00:00', '--job-id', '122', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpiwggfcew']\n[2025-04-14T04:16:30.949+0000] {standard_task_runner.py:105} INFO - Job 122: Subtask print_date\n[2025-04-14T04:16:31.082+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T04:16:23.390985+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T04:16:31.297+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T04:16:23.390985+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T04:16:23.390985+00:00'\n[2025-04-14T04:16:31.302+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T04:16:31.303+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T04:16:31.305+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 04:16:30.409130+00:00\n[2025-04-14T04:16:31.308+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T04:16:31.313+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T04:16:31.316+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T04:16:31.357+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T04:16:31.359+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 04:16:30.409130+00:00 end:2025-04-14 04:16:31.357148+00:00 duration:0.948018\n[2025-04-14T04:16:31.361+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 04:16:23.390985+00:00: manual__2025-04-14T04:16:23.390985+00:00, state:running, queued_at: 2025-04-14 04:16:23.496059+00:00. externally triggered: True>\n[2025-04-14T04:16:31.362+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T04:16:31.366+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T04:16:23.390985+00:00, execution_date=20250414T041623, start_date=20250414T041630, end_date=20250414T041631\n[2025-04-14T04:16:31.432+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T04:16:31.434+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 122 for task print_date (name 'subprocess' is not defined; 221)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T04:16:31.471+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T04:16:31.521+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T04:16:31.531+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  },
  {
    "id": "9b91d160-e84e-4998-b3ef-acfc05805872",
    "dag_name": "modern_slack_notification_dag",
    "timestamp": "2025-04-14T04:17:44.522875+00:00",
    "response": {
      "print_date": "98afc59ad8de\n INFO - ::group::Log message source details\n*** Found local files:\n***   * /opt/airflow/logs/dag_id=modern_slack_notification_dag/run_id=manual__2025-04-14T04:16:23.390985+00:00/task_id=print_date/attempt=1.log\n INFO - ::endgroup::\n[2025-04-14T04:16:30.361+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs\n[2025-04-14T04:16:30.407+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T04:16:23.390985+00:00 [queued]>\n[2025-04-14T04:16:30.807+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T04:16:23.390985+00:00 [queued]>\n[2025-04-14T04:16:30.809+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1\n[2025-04-14T04:16:30.899+0000] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): print_date> on 2025-04-14 04:16:23.390985+00:00\n[2025-04-14T04:16:30.921+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=212) is multi-threaded, use of fork() may lead to deadlocks in the child.\n  pid = os.fork()\n[2025-04-14T04:16:30.927+0000] {standard_task_runner.py:72} INFO - Started process 221 to run task\n[2025-04-14T04:16:30.939+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'modern_slack_notification_dag', 'print_date', 'manual__2025-04-14T04:16:23.390985+00:00', '--job-id', '122', '--raw', '--subdir', 'DAGS_FOLDER/slack_notifier_dag.py', '--cfg-path', '/tmp/tmpiwggfcew']\n[2025-04-14T04:16:30.949+0000] {standard_task_runner.py:105} INFO - Job 122: Subtask print_date\n[2025-04-14T04:16:31.082+0000] {task_command.py:467} INFO - Running <TaskInstance: modern_slack_notification_dag.print_date manual__2025-04-14T04:16:23.390985+00:00 [running]> on host 98afc59ad8de\n[2025-04-14T04:16:31.297+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='modern_slack_notification_dag' AIRFLOW_CTX_TASK_ID='print_date' AIRFLOW_CTX_EXECUTION_DATE='2025-04-14T04:16:23.390985+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-14T04:16:23.390985+00:00'\n[2025-04-14T04:16:31.302+0000] {logging_mixin.py:190} INFO - Task instance is in running state\n[2025-04-14T04:16:31.303+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued\n[2025-04-14T04:16:31.305+0000] {logging_mixin.py:190} INFO - Current task name:print_date state:running start_date:2025-04-14 04:16:30.409130+00:00\n[2025-04-14T04:16:31.308+0000] {logging_mixin.py:190} INFO - Dag name:modern_slack_notification_dag and current dag run status:running\n[2025-04-14T04:16:31.313+0000] {taskinstance.py:732} INFO - ::endgroup::\n[2025-04-14T04:16:31.316+0000] {taskinstance.py:3313} ERROR - Task failed with exception\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T04:16:31.357+0000] {logging_mixin.py:190} INFO - Task instance in failure state\n[2025-04-14T04:16:31.359+0000] {logging_mixin.py:190} INFO - Task start:2025-04-14 04:16:30.409130+00:00 end:2025-04-14 04:16:31.357148+00:00 duration:0.948018\n[2025-04-14T04:16:31.361+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): print_date> dag:<DAG: modern_slack_notification_dag> dagrun:<DagRun modern_slack_notification_dag @ 2025-04-14 04:16:23.390985+00:00: manual__2025-04-14T04:16:23.390985+00:00, state:running, queued_at: 2025-04-14 04:16:23.496059+00:00. externally triggered: True>\n[2025-04-14T04:16:31.362+0000] {logging_mixin.py:190} INFO - Failure caused by name 'subprocess' is not defined\n[2025-04-14T04:16:31.366+0000] {taskinstance.py:1226} INFO - Marking task as FAILED. dag_id=modern_slack_notification_dag, task_id=print_date, run_id=manual__2025-04-14T04:16:23.390985+00:00, execution_date=20250414T041623, start_date=20250414T041630, end_date=20250414T041631\n[2025-04-14T04:16:31.432+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs\n[2025-04-14T04:16:31.434+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 122 for task print_date (name 'subprocess' is not defined; 221)\nTraceback (most recent call last):\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py\", line 117, in _start_by_fork\n    ret = args.func(args, dag=self.dag)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py\", line 49, in command\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py\", line 116, in wrapper\n    return f(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 483, in task_run\n    task_return_code = _run_task_by_selected_method(args, _dag, ti)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 256, in _run_task_by_selected_method\n    return _run_raw_task(args, ti)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py\", line 341, in _run_raw_task\n    return ti._run_raw_task(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py\", line 97, in wrapper\n    return func(*args, session=session, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3006, in _run_raw_task\n    return _run_raw_task(\n           ^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 274, in _run_raw_task\n    TaskInstance._execute_task_with_callbacks(\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3161, in _execute_task_with_callbacks\n    result = self._execute_task(context, task_orig)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 3185, in _execute_task\n    return _execute_task(self, context, task_orig)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 768, in _execute_task\n    result = _execute_callable(context=context, **execute_callable_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py\", line 734, in _execute_callable\n    return ExecutionCallableRunner(\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py\", line 266, in execute\n    return_value = super().execute(context)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py\", line 424, in wrapper\n    return func(self, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 238, in execute\n    return_value = self.execute_callable()\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py\", line 256, in execute_callable\n    return runner.run(*self.op_args, **self.op_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py\", line 252, in run\n    return self.func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/airflow/dags/slack_notifier_dag.py\", line 52, in print_date\n    subprocess.run([\"date\"], check=True)\n    ^^^^^^^^^^\nNameError: name 'subprocess' is not defined. Did you forget to import 'subprocess'\n[2025-04-14T04:16:31.471+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1\n[2025-04-14T04:16:31.521+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check\n[2025-04-14T04:16:31.531+0000] {local_task_job_runner.py:245} INFO - ::endgroup::\n",
      "sleep_task": "default_host\nError fetching the logs. Try number 0 is invalid.\n"
    }
  }
]